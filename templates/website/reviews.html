{% extends 'base.html' %}
{% block content %}
{% load widget_tweaks %}
<!-- {% load static %}   Load the static tag at the top of the template 

<link href="{% static 'website/custom.css' %}" rel="stylesheet" type="text/css"> -->
<style>
    .container {
        max-width: 600px;
        margin: auto;
    }

    .section-heading {
        text-align: center;
        margin-bottom: 30px;
    }

    .form-group {
        margin-bottom: 20px;
    }

    label {
        font-weight: bold;
    }

    .form-control {
        width: 100%;
        padding: 10px;
        border: 1px solid #ccc;
        border-radius: 4px;
        box-sizing: border-box;
    }

    textarea.form-control {
        resize: vertical;
    }

    .btn-primary {
        background-color: #007bff;
        color: white;
        border: none;
        padding: 10px 20px;
        border-radius: 4px;
        cursor: pointer;
    }

    .btn-primary:hover {
        background-color: #0056b3;
    }

    .rate>input {
        display: none;
    }

    .rate {
        display: inline-block;
        border: 0;
    }

    .rate>label {
        float: right
    }

    .rate>label:before {
        display: inline-block;
        font-size: 1.1rem;
        font-family: FontAwesome;
        content: "\f005";
        margin: 0;
        padding: 0.3rem .2rem;
        cursor: pointer;
    }

    /* Half star*/
    .rate .half:before {
        content: "\f089";
        position: absolute;
        padding-right: 0;

    }

    /* click and hover*/
    input:checked~label,
    label:hover~label {
        color: #ffb503;
    }

    /* hover highlight*/
    input:checked+label:hover,
    input:checked~label:hover,
    input:checked~label:hover~label,
    label:hover~input:checked~label {
        color: #cc9000;
    }
    .container {
        max-width: 800px;
        margin: auto;
        padding: 20px;
    }

    .review-list {
        list-style: none;
        padding: 0;
    }

    .review-item {
        margin-bottom: 20px;
        padding: 15px;
        border-radius: 8px;
        box-shadow: 0 0 10px rgba(0, 0, 0, 0.1);
        background-color: #f9f9f9;
    }

    .review-item h4 {
        margin-bottom: 5px;
        font-size: 18px;
        color: #333;
    }

    .review-item .rating {
        margin-bottom: 10px;
    }

    .review-item p {
        margin-bottom: 0;
        font-size: 16px;
        color: #555;
    }

    .review-item .author {
        font-weight: bold;
        color: #007bff;
    }
</style>

<div class="container">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
    <form action="" method="POST" class="review-form">
        {% csrf_token %}
        <h5>Write Your Review:</h5>
        <label>How Do You Rate Our website?</label>
        <br>
        <div class="rate">
            <input type="radio" name="rating" id="rating10" value="5" required /><label for="rating10"
                title="5"></label>
            <input type="radio" name="rating" id="rating9" value="4.5" required /><label for="rating9" title="4.5"
                class="half"></label>
            <input type="radio" name="rating" id="rating8" value="4" required /><label for="rating8" title="4"></label>
            <input type="radio" name="rating" id="rating7" value="3.5" required /><label for="rating7" title="3.5"
                class="half"></label>
            <input type="radio" name="rating" id="rating6" value="3" required /><label for="rating6" title="3"></label>
            <input type="radio" name="rating" id="rating5" value="2.5" required /><label for="rating5" title="2.5"
                class="half"></label>
            <input type="radio" name="rating" id="rating4" value="2" required /><label for="rating4" title="2"></label>
            <input type="radio" name="rating" id="rating3" value="1.5" required /><label for="rating3" title="1.5"
                class="half"></label>
            <input type="radio" name="rating" id="rating2" value="1" required /><label for="rating2" title="1"></label>
            <input type="radio" name="rating" id="rating1" value="0.5" required /><label for="rating1" title="0.5"
                class="half"></label>

        </div>

        <div class="form-group">
            <label for="subject">Review Title:</label>
            <input type="text" class="form-control" id="subject" name="subject">
        </div>
        <div class="form-group">
            <label for="review">Review:</label>
            <textarea name="review" rows="4" class="form-control" id="review"></textarea>
        </div>
        <button type="submit" class="btn btn-primary">Submit Review</button>
        <br>
    </form>
</div>
<script>
document.addEventListener('DOMContentLoaded', function() {
    var reviewTimes = document.querySelectorAll('.time');
    reviewTimes.forEach(function(timeElement) {
        var createdTime = new Date(timeElement.dataset.created);
        var currentTime = new Date();
        var timeDiff = Math.abs(currentTime - createdTime); // Calculate time difference in milliseconds
        var formattedTime = formatTimeDifference(timeDiff);
        timeElement.textContent = formattedTime;
    });

    function formatTimeDifference(timeDiff) {
        var seconds = Math.floor(timeDiff / 1000);
        var minutes = Math.floor(seconds / 60);
        var hours = Math.floor(minutes / 60);
        var days = Math.floor(hours / 24);

        if (days > 0) {
            return days + (days === 1 ? ' day ago' : ' days ago');
        } else if (hours > 0) {
            return hours + (hours === 1 ? ' hour ago' : ' hours ago');
        } else if (minutes > 0) {
            return minutes + (minutes === 1 ? ' minute ago' : ' minutes ago');
        } else {
            return 'Just now';
        }
    }
});
</script>

        <header class="section-heading">
            <h3>All Reviews</h3>
        </header>
        
    <ul class="review-list">
        {% for review in reviews_list %}
            <li class="review-item">
                <h4>{{ review.subject }}</h4>
                <div class="rating">
                    Rating: {{ review.rating }}
                </div>
                <p>{{ review.review }}</p>
                <div class="author">By: {{ review.user.username }}</div>
                <div class="time" data-created="{{ review.created_at|date:'c' }}"></div>  <!-- Store review creation time -->
            </li>
        {% endfor %}
    </ul>


{% endblock content %}